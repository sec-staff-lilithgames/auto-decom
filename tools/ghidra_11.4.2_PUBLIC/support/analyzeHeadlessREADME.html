<h1 id="headless-analyzer-readme" style="border-bottom: solid 1px; border-bottom-color: #cccccc; padding-bottom: 8px;">Headless Analyzer README</h1>
<h2 id="table-of-contents" style="border-bottom: solid 1px; border-bottom-color: #cccccc; padding-bottom: 8px;">Table of Contents</h2>
<ol>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#scripting">Scripting</a>
<ul>
<li><a href="#passing-parameters-using-arguments">Passing Parameters using arguments</a></li>
<li><a href="#passing-parameters-using-askxxx-methods">Passing Parameters using <code style="background-color: #eef;">askXxx()</code> methods</a></li>
<li><a href="#headless-scripts">Headless Scripts</a>
<ul>
<li><a href="#enablingdisabling-analysis">Enabling/Disabling Analysis</a></li>
<li><a href="#setting-the-import-directory">Setting the Import Directory</a></li>
<li><a href="#checking-for-analysis-timeout">Checking for Analysis Timeout</a></li>
<li><a href="#passing-values-between-scripts">Passing Values Between Scripts</a></li>
<li><a href="#using-scripts-to-control-program-disposition">Using Scripts to Control Program Disposition</a></li>
<li><a href="#using-multiple-scripts-to-control-program-disposition">Using Multiple Scripts to Control Program Disposition</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#wildcards">Wildcards</a></li>
</ol>
<h2 id="introduction" style="border-bottom: solid 1px; border-bottom-color: #cccccc; padding-bottom: 8px;">Introduction</h2>
<p>The Headless Analyzer is a command-line-based (non-GUI) version of Ghidra that allows users to:</p>
<ul>
<li>Create and populate projects</li>
<li>Perform analysis on imported or existing binaries</li>
<li>Run non-GUI scripts in a project (scripts may be program-dependent or program-independent)</li>
</ul>
<p>The Headless Analyzer can be useful when performing repetitive tasks on a project (i.e., importing
and analyzing a directory of files or running a script over all the binaries in a project).</p>
<p>Users initiate Headless operation using the <code style="background-color: #eef;">analyzeHeadless</code> shell script.
The shell script takes, at a minimum, the path and name of an existing project (or one to be
created). When other parameters are specified, the following types of actions may be performed:</p>
<ul>
<li><a href="#-import-directoryfile">Import</a> a single file or directory of executable(s) (recursively or non-recursively).</li>
<li><a href="#-process-project_file">Process</a> a single file or directory of executable(s) already present in an existing
project (recursively or non-recursively).</li>
<li>Run any number of non-GUI Ghidra <a href="#-prescript-scriptnameext-arg">pre-processing scripts</a> on each executable.</li>
<li>Turn analysis on or <a href="#-noanalysis">off</a> for each executable.</li>
<li>Run any number of non-GUI Ghidra <a href="#-postscript-scriptnameext-arg">post-processing scripts</a> on each executable.</li>
<li>Write to a <a href="#-log-path-to-log-file">log</a> with information about each file processed. <a href="#-scriptlog-path-to-script-log-file">Separated logging</a>
is available for scripts.</li>
<li>Keep or <a href="#-deleteproject">delete</a> a created project.</li>
<li>Save any changes made to the project/file, or operate in a <a href="#-readonly">read-only</a> manner in
<a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> or <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> modes.</li>
<li>Use pre- and/or post-processing scripts to dictate <a href="#using-multiple-scripts-to-control-program-disposition">program disposition</a>. For
example, scripts can dictate whether further processing (i.e., analysis or other scripts) should
be aborted and whether the current file should be deleted after all processing is complete.</li>
</ul>
<p>While running, be aware that:</p>
<ul>
<li>The Headless Analyzer may not run if the specified project is already open in Ghidra.</li>
<li>In bulk import mode (i.e., specifying a directory, <code style="background-color: #eef;">-import dirOfExes</code>, or wildcard string,
<code style="background-color: #eef;">-import dir1/*</code>), any file beginning with the character <code style="background-color: #eef;">.</code> is assumed to be a hidden file and
ignored by default. However, when a file beginning with <code style="background-color: #eef;">.</code> is named during import (for example,
<code style="background-color: #eef;">import /Users/user/.hidden.exe</code>), the Headless Analyzer will attempt to import it.</li>
<li>Log files can only be redirected if Log4J is used.</li>
</ul>
<h2 id="usage" style="border-bottom: solid 1px; border-bottom-color: #cccccc; padding-bottom: 8px;">Usage</h2>
<p>The Headless Analyzer uses the command-line parameters discussed below. See <a href="#examples">Examples</a>
for common use cases.</p>
<pre>
    analyzeHeadless <a href="#project_location">&lt;project_location&gt;</a> &lt;<a href="#project_namefolder_path">project_name&gt;[/&lt;folder_path&gt;]</a> | <a href="#ghidraserverportrepository_namefolder_path">ghidra://&lt;server&gt;[:&lt;port&gt;]/&lt;repository_name&gt;[/&lt;folder_path&gt;]</a>
        [[<a href="#-import-directoryfile">-import [&lt;directory&gt;|&lt;file&gt;]+</a>] | [<a href="#-process-project_file">-process [&lt;project_file&gt;]]</a>]
        [<a href="#-prescript-scriptnameext-arg">-preScript &lt;ScriptName&gt;&nbsp;[&lt;arg&gt;]*</a>]
        [<a href="#-postscript-scriptnameext-arg">-postScript &lt;ScriptName&gt;&nbsp[&lt;arg&gt;]*</a>]
        [<a href="#-scriptpath-path1path2">-scriptPath &quot;&lt;path1&gt;[;&lt;path2&gt;...]&quot;</a>]
        [<a href="#-propertiespath-path1path2">-propertiesPath &quot;&lt;path1&gt;[;&lt;path2&gt;...]&quot;</a>]
        [<a href="#-scriptlog-path-to-script-log-file">-scriptlog &lt;path to script log file&gt;</a>]
        [<a href="#-log-path-to-log-file">-log &lt;path to log file&gt;</a>]
        [<a href="#-overwrite">-overwrite</a>]
        [<a href="#-recursive-depth">-recursive [&lt;depth&gt;]</a>]
        [<a href="#-readonly">-readOnly</a>]
        [<a href="#-deleteproject">-deleteProject</a>]
        [<a href="#-noanalysis">-noanalysis</a>]
        [<a href="#-processor-languageid">-processor &lt;languageID&gt;</a>]
        [<a href="#-cspec-compilerspecid">-cspec &lt;compilerSpecID&gt;</a>]
        [<a href="#-analysistimeoutperfile-timeout-in-seconds">-analysisTimeoutPerFile &lt;timeout in seconds&gt;</a>]
        [<a href="#-keystore-keystorepath">-keystore &lt;KeystorePath&gt;</a>]
        [<a href="#-connect-userid">-connect [&lt;userID&gt;]</a>]
        [<a href="#-p">-p</a>]
        [<a href="#-commit-comment">-commit [&quot;&lt;comment&gt;&quot;]</a>]
        [<a href="#-oktodelete">-okToDelete</a>]
        [<a href="#-max-cpu-max-cpu-cores-to-use">-max-cpu &lt;max cpu cores to use&gt;</a>]
        [<a href="#-librarysearchpaths-path1path2">-librarySearchPaths &lt;path1&gt;[;&lt;path2&gt;...]</a>]
        [<a href="#-loader-desired-loader-name">-loader &lt;desired loader name&gt;</a>]
        [<a href="#-loader-desired-loader-name">-loader-&lt;loader argument name&gt; &lt;loader argument value&gt;</a>]
</pre>
<h3 id="project_location"><code style="background-color: #eef;">&lt;project_location&gt;</code></h3>
<p>The directory that either contains an existing Ghidra project (in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> or
<a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode) or will contain a newly created project (in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode for
a local project).</p>
<p><em><strong>You must specify either a project location and project name, or a Ghidra Server repository URL.</strong></em></p>
<p>Some parameters will have no effect, depending on which <code style="background-color: #eef;">project_location</code> is specified. The
following table shows parameters that are specific to <code style="background-color: #eef;">project_location</code>:</p>
<table style="border: 1px solid black; border-collapse: collapse; padding: 5px;">
<thead>
<tr>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">Parameter</th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">Local Project</th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">Server Repository</th>
</tr>
</thead>
<tbody>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">-p</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">X</td>
</tr>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">-connect</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">X</td>
</tr>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">-keystore</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">X</td>
</tr>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">-commit</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">X</td>
</tr>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">-delete</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">X</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"></td>
</tr>
</tbody>
</table>
<h3 id="project_namefolder_path"><code style="background-color: #eef;">&lt;project_name&gt;[/&lt;folder_path&gt;]</code></h3>
<p>The name of either an existing project (in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> or <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode) or new
project (in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode) to be created in the above directory. If the optional folder
path is included, imports will be rooted under this project folder. In <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode with
<a href="#-recursive-depth"><code style="background-color: #eef;">-recursive</code></a> enabled, any folders in the folder path that do not already exist in the
project will be created (even if nested).</p>
<p><em><strong>You must specify either a project location and project name, or a Ghidra Server repository URL.</strong></em></p>
<h3 id="ghidraserverportrepository_namefolder_path"><code style="background-color: #eef;">ghidra://&lt;server&gt;[:&lt;port&gt;]/&lt;repository_name&gt;[/&lt;folder_path&gt;]</code></h3>
<p>A Ghidra Server repository URL (shared Ghidra Server project) and folder path. Using the repository
URL eliminates the need for a local shared Ghidra project; however, the named repository must
already exist on the Ghidra Server. If the specified repository does not already exist, it will not
be created (see the <code style="background-color: #eef;">GhidraProject</code> class for a simple API that allows shared project creation from
within a script).</p>
<p>If the optional folder path is included, imports will be rooted under this folder (in
<a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode, folders will be created if they do not already exist).</p>
<h3 id="-import-directoryfile"><code style="background-color: #eef;">-import [&lt;directory&gt;|&lt;file&gt;]+</code></h3>
<p><em>Note: <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> and <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> can not both be present in the parameters list.</em></p>
<p>Specifies one or more executables (or directories of executables) to import. When importing a
directory or supported container format, a folder with the same name will be created in the Ghidra
project. When using the <a href="#-recursive-depth"><code style="background-color: #eef;">-recursive</code></a> parameter, each executable that is found in a
recursive search through the given directory or container file will be stored in the project in the
same relative location (i.e., any directories found under the import directory will also be created
in the project).</p>
<p>Operating system-specific wildcard characters can be used when importing files and/or directories.
Please see the <a href="#wildcards">Wildcards</a> section for more details.</p>
<p>When importing multiple executables/directories in the same session, use one of the following
methods:</p>
<ul>
<li>List multiple directories and/or executables after the <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> option, separated by a
space.
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">-import /Users/myDir/peFiles /Users/myDir/otherFiles/test.exe
</code></pre>
</li>
<li>Repeat the <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> option multiple times (each use of <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> may be
separated by other parameters) to import from more than one directory or file source.
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">-import /Users/myDir/peFiles -recursive -import /Users/myDir/otherFiles/test.exe
</code></pre>
</li>
</ul>
<h3 id="-process-project_file"><code style="background-color: #eef;">-process [&lt;project_file&gt;]</code></h3>
<p><em>Note: <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> and <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> can not both be present in the parameters list.</em></p>
<p>Performs processing (running pre/post-scripts and/or analysis) on one or more program files
that already exist in the project or repository. Use the optional <code style="background-color: #eef;">project_file</code> argument to specify
an existing file by name.  Searching will be performed within the specified project folder
(specified by <code style="background-color: #eef;">folder_path</code>, which was included with the <a href="#project_namefolder_path">project_name</a> or
<a href="#ghidraserverportrepository_namefolder_path">repository URL</a> specification). Omit the <code style="background-color: #eef;">project_file</code> argument to allow processing
over all files within the project folder.</p>
<p>You can also use the wildcard characters <code style="background-color: #eef;">*</code> and <code style="background-color: #eef;">?</code> in the <code style="background-color: #eef;">project_file</code> parameter to specify all
files within a folder which match the pattern. To prevent premature expansion (by the shell) of any
wildcard characters, use single quotes around the <code style="background-color: #eef;">project_file</code>. For example:</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">-process '*.exe'
</code></pre>
<p>For further details on wildcard usage, please see the <a href="#wildcards">Wildcards</a> section
below.</p>
<p>Omitting the optional <code style="background-color: #eef;">project_file</code> argument will cause all files to be processed within the
project folder (equivelent to <code style="background-color: #eef;">*</code>).</p>
<p>Including the <a href="#-recursive-depth"><code style="background-color: #eef;">-recursive</code></a> parameter will cause the same project file name/pattern
search to be performed recursively within all sub-folders.</p>
<p>Unlike the <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> option, <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> may only be specified once.</p>
<h3 id="-prescript-scriptnameext-arg"><code style="background-color: #eef;">-preScript &lt;ScriptName.ext&gt; [&lt;arg&gt;]*</code></h3>
<p>Identifies the name of a script that will execute before analysis, and an optional list of arguments
to pass to the script. The script name must include its file extension (i.e., <em>MyScript.java</em>).</p>
<p><em><strong>This parameter expects the script name only; do not include the path to the script.</strong></em> The
Headless Analyzer searches specific default locations for the named script, but additional script
director(ies) may also be specified (see the <a href="#-scriptpath-path1path2"><code style="background-color: #eef;">-scriptPath</code></a> argument for more
information).</p>
<p>This option must be repeated to specify additional scripts. See the <a href="#scripting">Scripting</a> section
for a description of advanced scripting capabilities.</p>
<h3 id="-postscript-scriptnameext-arg"><code style="background-color: #eef;">-postScript &lt;ScriptName.ext&gt; [&lt;arg&gt;]*</code></h3>
<p>Identifies the name of a script that will execute after analysis, and an optional list of arguments
to pass to the script. The script name must include its file extension (i.e., <em>MyScript.java</em>).</p>
<p><em><strong>This parameter expects the script name only; do not include the path to the script.</strong></em> The
Headless Analyzer searches specific default locations for the named script, but additional script
director(ies) may also be specified (see the <a href="#-scriptpath-path1path2"><code style="background-color: #eef;">-scriptPath</code></a> argument for more
information).</p>
<p>This option must be repeated to specify additional scripts. See the <a href="#scripting">Scripting</a> section
for a description of advanced scripting capabilities.</p>
<h3 id="-scriptpath-path1path2"><code style="background-color: #eef;">-scriptPath &quot;&lt;path1&gt;[;&lt;path2&gt;...]&quot;</code></h3>
<p>Specifies the search path(s) for scripts, including secondary scripts (a script invoked from
another script). A path may start with <code style="background-color: #eef;">$GHIDRA_HOME</code>, which corresponds to the Ghidra installation
directory, or <code style="background-color: #eef;">$USER_HOME</code>, which corresponds to the user's home directory. On Unix systems, these
home variables must be escaped using a <code style="background-color: #eef;">\</code> (backslash) character.</p>
<p>Examples:</p>
<ul>
<li>Windows:
<pre style="background-color: #eef;"><code class="language-bat" style="background-color: #eef;">-scriptPath &quot;$GHIDRA_HOME/Ghidra/Features/Base/ghidra_scripts;/myscripts&quot;
</code></pre>
</li>
<li>Unix:
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">-scriptPath &quot;\$GHIDRA_HOME/Ghidra/Features/Base/ghidra_scripts;/myscripts&quot;
</code></pre>
</li>
</ul>
<p>The <code style="background-color: #eef;">scriptPath</code> parameter is optional. If it is not present, the Headless Analyzer will search the
following paths for the specified script(s):</p>
<ul>
<li><code style="background-color: #eef;">$USER_HOME/ghidra_scripts</code></li>
<li>All <code style="background-color: #eef;">ghidra_script</code> subdirectories that exist in the Ghidra distribution</li>
</ul>
<h3 id="-propertiespath-path1path2"><code style="background-color: #eef;">-propertiesPath &quot;&lt;path1&gt;[;&lt;path2&gt;...]&quot;</code></h3>
<p>Specifies path(s) that contain <em>.properties</em> files used by scripts or secondary/subscripts. A path
may start with <code style="background-color: #eef;">$GHIDRA_HOME</code>, which corresponds to the Ghidra installation directory, or
<code style="background-color: #eef;">$USER_HOME</code>, which corresponds to the user's home directory. On Unix systems these home variables
must be escaped with a <code style="background-color: #eef;">;</code> character.</p>
<p>More information on the use of <em>.properties</em> files to pass parameters during Headless Analysis can
be found <a href="#passing-parameters-using-askxxx-methods">here</a>.</p>
<h3 id="-scriptlog-path-to-script-log-file"><code style="background-color: #eef;">-scriptlog &lt;path to script log file&gt;</code></h3>
<p>Sets the location of the file that stores logging information from pre- and post-scripts. If a
path to a script log file is not set, script logs are written to <code style="background-color: #eef;">script.log</code> in the user directory,
by default.</p>
<p>Note: Only the built-in scripting print methods will print to the script log file (<code style="background-color: #eef;">print</code>,
<code style="background-color: #eef;">println</code>, <code style="background-color: #eef;">printf</code>, <code style="background-color: #eef;">printerr</code>).</p>
<p>Also note that in Python scripts, <code style="background-color: #eef;">print</code> writes to <code style="background-color: #eef;">stdout</code>.  To write to the log from Python, use
<code style="background-color: #eef;">println</code> instead.</p>
<h3 id="-log-path-to-log-file"><code style="background-color: #eef;">-log &lt;path to log file&gt;</code></h3>
<p>Sets the location of the file that stores logging information from analysis or other non-script
processing of the files. If a path to a log file is not set, logging information is written to
<code style="background-color: #eef;">application.log</code> in the user directory, by default.</p>
<h3 id="-overwrite"><code style="background-color: #eef;">-overwrite</code></h3>
<p>Applies to <a href="#-import-directoryfile">-import</a> mode only and is ignored if the <a href="#-readonly"><code style="background-color: #eef;">-readOnly</code></a> option is
present. If present, an existing project file that conflicts with an import file is overwritten.
If this parameter is not included, import files that conflict with existing project files will be
skipped (if not operating with the <a href="#-readonly"><code style="background-color: #eef;">-readOnly</code></a> option). If a conflicting file is
contained within a version repository, and the <a href="#-commit-comment"><code style="background-color: #eef;">-commit</code></a> option has not been specified,
the overwrite will fail.  Removing a versioned file is also subject to other permission and in-use
restrictions which could also cause an overwrite failure.</p>
<h3 id="-recursive-depth"><code style="background-color: #eef;">-recursive [&lt;depth&gt;]</code></h3>
<p>If present, enables recursive descent into directories and project sub-folders when a directory/
folder has been specified in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> or <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> modes.</p>
<p>Specifying a positive integer value for the optional <code style="background-color: #eef;">&lt;depth&gt;</code> argument enables recursive descent
into supported container files (e.g., zip, tar, .a, etc). The depth value only applies to nested
container files. Intermediate directories found within each nested container file are not affected
by the specified depth value.  If a depth value is not specified, it will default to 0 if importing
a directory, and 1 if importing a file.  A depth of 0 will prevent recursing into any container
files.</p>
<h3 id="-readonly"><code style="background-color: #eef;">-readOnly</code></h3>
<p>If present in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode, imported files will NOT be saved to the project. If present
in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode, any changes made to existing files by scripts or analysis are
discarded.  When processing a shared project or URL associated with a read-only repository, such
files will be skipped unless this option is specified. The <a href="#-overwrite"><code style="background-color: #eef;">-overwrite</code></a> option will be
ignored if this option is specified  during import operations.</p>
<h3 id="-deleteproject"><code style="background-color: #eef;">-deleteProject</code></h3>
<p>If present, the Ghidra project will be deleted after scripts and/or analysis have completed
(only applies if the project has been created in the current session with
<a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a>; existing projects are never deleted). This project delete option is assumed
when the <a href="#-readonly"><code style="background-color: #eef;">-readOnly</code></a> option is specified for import operations which create a new
project.</p>
<h3 id="-noanalysis"><code style="background-color: #eef;">-noanalysis</code></h3>
<p>If present, executables will not be analyzed (auto-analysis occurs by default).</p>
<h3 id="-processor-languageid"><code style="background-color: #eef;">-processor &lt;languageID&gt;</code></h3>
<p>Specifies the processor information to be used in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode (and subsequent analysis,
if analysis is enabled). Be sure to use quotes around the <code style="background-color: #eef;">languageId</code> if it contains spaces. If
this parameter is not present, Ghidra uses header info (if available) to identify the processor.</p>
<p>The possible <em>languageIDs</em> can be found in the processor-specific <em>.ldefs</em> files (found here:
<code style="background-color: #eef;">ghidra_x.x\Ghidra\Processors\proc_name\data\languages\*.ldefs</code>) in the <code style="background-color: #eef;">id</code> attribute of the
<code style="background-color: #eef;">language</code> element. The specified <code style="background-color: #eef;">&lt;languageID&gt;</code> should match exactly, including case, as it appears
in the <em>.ldefs</em> file.</p>
<p>For example:</p>
<pre style="background-color: #eef;"><code class="language-xml" style="background-color: #eef;">&lt;language processor=&quot;x86&quot;
            endian=&quot;little&quot;
            size=&quot;32&quot;
            variant=&quot;default&quot;
            version=&quot;2.6&quot;
            slafile=&quot;x86.sla&quot;
            processorspec=&quot;x86.pspec&quot;
            manualindexfile=&quot;../manuals/x86.idx&quot;
            id=&quot;x86:LE:32:default&quot;&gt;
</code></pre>
<p><em>Note: The <a href="#-processor-languageid"><code style="background-color: #eef;">-processor</code></a> parameter may be used without specifying the <a href="#-cspec-compilerspecid"><code style="background-color: #eef;">-cspec</code></a>
parameter (if the given processor is valid, the Headless Analyzer chooses the default compiler
specification for that processor).</em></p>
<h3 id="-cspec-compilerspecid"><code style="background-color: #eef;">-cspec &lt;compilerSpecID&gt;</code></h3>
<p>Specifies the compiler specification to be used in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode (and subsequent
analysis, if analysis is enabled).</p>
<p>The possible <em>compilerSpecIDs</em> can be found in the processor-specific <em>.ldefs</em> files (found here:
<code style="background-color: #eef;">ghidra_x.x\Ghidra\Processors\proc_name\data\languages\*.ldefs</code>) in the <code style="background-color: #eef;">id</code> attribute of the
appropriate <code style="background-color: #eef;">compiler</code> element. The specified <code style="background-color: #eef;">&lt;compilerSpecID&gt;</code> should match exactly, including
case, as it appears in the <em>.ldefs</em> file.</p>
<p>For example:</p>
<pre style="background-color: #eef;"><code class="language-xml" style="background-color: #eef;">&lt;compiler name=&quot;Visual Studio&quot; spec=&quot;x86win.cspec&quot; id=&quot;windows&quot;/&gt;
&lt;compiler name=&quot;gcc&quot; spec=&quot;x86gcc.cspec&quot; id=&quot;gcc&quot;/&gt;
&lt;compiler name=&quot;Borland C++&quot; spec=&quot;x86borland.cspec&quot; id=&quot;borlandcpp&quot;/&gt;
</code></pre>
<p><em>Note: The <a href="#-cspec-compilerspecid"><code style="background-color: #eef;">-cspec</code></a> parameter may <strong>not</strong> be used without specifying the
<a href="#-processor-languageid"><code style="background-color: #eef;">-processor</code></a> parameter.</em></p>
<h3 id="-analysistimeoutperfile-timeout-in-seconds"><code style="background-color: #eef;">-analysisTimeoutPerFile &lt;timeout in seconds&gt;</code></h3>
<p>Sets a timeout value (in seconds) for analysis. If analysis on a file exceeds the specified time,
analysis is interrupted and processing continues as scheduled (i.e., to the
<a href="#-postscript-scriptnameext-arg"><code style="background-color: #eef;">-postScript</code></a> stage, if specified). Results from individual analyzers that have
completed processing prior to timeout will still be saved with the program. Post-scripts can be used
to detect that analysis has timed out (in Headless processing ONLY) by calling the
<code style="background-color: #eef;">getHeadlessAnalysisTimeoutStatus()</code> method.</p>
<h3 id="-keystore-keystorepath"><code style="background-color: #eef;">-keystore &lt;KeystorePath&gt;</code></h3>
<p>When connecting to a Ghidra Server using PKI or SSH authentication, this option allows
specification of a suitable private keystore file. The keystore file should always be properly
protected with filesystem protections. Since SSH authentication is intended for batch operations,
we do not support password protected SSH keys. However, we do support password prompting for
PKI authentication.</p>
<p><a href="#authentication">See here for more information regarding which authentication method to use</a>.</p>
<h3 id="-connect-userid"><code style="background-color: #eef;">-connect &lt;userID&gt;</code></h3>
<p>If used, allows the process owner's default userID to be overridden with the given <code style="background-color: #eef;">userID</code> when
connecting to a Ghidra Server. In order to use this parameter, the server must be configured to
allow a non-default username (Ghidra server <code style="background-color: #eef;">-u</code> option).</p>
<h3 id="-p"><code style="background-color: #eef;">-p</code></h3>
<p>This option may be specified to allow for interactive password prompting when either a specified
PKI keystore is password protected or the Ghidra Server requires password authentication.
This option should not be used during batch operations where a user will be unable to enter a
password. <strong>If the terminal in use is unable to suppress echoing an entered password, a warning will
be issued with the prompt, and the entered password will be echoed to the terminal. Use of this
option is discouraged when such a warning occurs.</strong></p>
<p><a href="#authentication">See here for more information regarding which authentication method to use</a>.</p>
<h3 id="-commit-comment"><code style="background-color: #eef;">-commit [&quot;&lt;comment&gt;&quot;]</code></h3>
<p>When connected to a shared project, enables a commit of changes to the project's underlying
repository (residing on the Ghidra Server). Commits are enabled by default for shared projects;
however, the optional quoted <code style="background-color: #eef;">comment</code> may be specified and will be saved with all commits. Commits
do not apply when the <a href="#-readonly">-readOnly</a> parameter is present.</p>
<h3 id="-oktodelete"><code style="background-color: #eef;">-okToDelete</code></h3>
<p>When using Headless Scripts to control <a href="#using-scripts-to-control-program-disposition">program disposition</a> in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a>
mode, it is possible to delete existing programs in a project. These deletions are permanent and can
not be undone (in a versioned project, all versions of a program are deleted). To ensure that
programs are not deleted irretrievably without the user's knowledge, Headless operation requires the
<a href="#-oktodelete"><code style="background-color: #eef;">-okToDelete</code></a> parameter to be set if a program is to be deleted in
<a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode. If a program is scheduled to be deleted and <a href="#-oktodelete"><code style="background-color: #eef;">-okToDelete</code></a>
has not been set, Headless will print a warning and the program will not be deleted.</p>
<p>The <a href="#-oktodelete"><code style="background-color: #eef;">-okToDelete</code></a> parameter is not necessary when running in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a>
mode. If a HeadlessScripts schedules deletion of one of the programs being imported, the program
will simply not be saved to the project.</p>
<h3 id="-max-cpu-max-cpu-cores-to-use"><code style="background-color: #eef;">-max-cpu &lt;max cpu cores to use&gt;</code></h3>
<p>Sets the maximum number of CPU cores to use during headless processing (must be an integer).
Setting <code style="background-color: #eef;">max-cpu</code> to 0 or a negative integer is equivalent to setting the maximum number of cores to
1.</p>
<h3 id="-librarysearchpaths-path1path2"><code style="background-color: #eef;">-librarySearchPaths &lt;path1&gt;[;&lt;path2&gt;...]</code></h3>
<p>Specifies an ordered list of library search paths to use during import instead of the default.
Search paths may be either full system paths or &quot;FSRLs&quot;.</p>
<h3 id="-loader-desired-loader-name"><code style="background-color: #eef;">-loader &lt;desired loader name&gt;</code></h3>
<p>Forces the file to be imported using a specific loader.</p>
<p>Loaders can take additional arguments that they apply during the import process. Below is a list of
the most commonly used loaders and their arguments.</p>
<p><strong>Note:</strong> Full java package loader paths are no longer recognized.</p>
<ul>
<li>
<p><code style="background-color: #eef;">-loader BinaryLoader</code></p>
<ul>
<li><code style="background-color: #eef;">-loader-blockName &lt;block name&gt;</code></li>
<li><code style="background-color: #eef;">-loader-baseAddr &lt;base address&gt;</code><sup class="footnote-ref"><a href="#fn-1" id="fnref-1" data-footnote-ref>1</a></sup></li>
<li><code style="background-color: #eef;">-loader-fileOffset &lt;file offset&gt;</code><sup class="footnote-ref"><a href="#fn-2" id="fnref-2" data-footnote-ref>2</a></sup></li>
<li><code style="background-color: #eef;">-loader-length &lt;length in bytes&gt;</code><sup class="footnote-ref"><a href="#fn-2" id="fnref-2-2" data-footnote-ref>2</a></sup></li>
<li><code style="background-color: #eef;">-loader-applyLabels &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-anchorLabels &lt;true|false&gt;</code></li>
</ul>
</li>
<li>
<p><code style="background-color: #eef;">-loader ElfLoader</code></p>
<ul>
<li><code style="background-color: #eef;">-loader-applyLabels &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-anchorLabels &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-linkExistingProjectLibraries &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-projectLibrarySearchFolder &lt;project path&gt;</code></li>
<li><code style="background-color: #eef;">-loader-loadLibraries &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-libraryLoadDepth &lt;depth&gt;</code></li>
<li><code style="background-color: #eef;">-loader-libraryDestinationFolder &lt;project path&gt;</code></li>
<li><code style="background-color: #eef;">-loader-applyRelocations &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-applyUndefinedData &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-imagebase &lt;imagebase&gt;</code><sup class="footnote-ref"><a href="#fn-3" id="fnref-3" data-footnote-ref>3</a></sup></li>
<li><code style="background-color: #eef;">-loader-dataImageBase &lt;dataImageBase&gt;</code><sup class="footnote-ref"><a href="#fn-4" id="fnref-4" data-footnote-ref>4</a></sup></li>
<li><code style="background-color: #eef;">-loader-includeOtherBlocks &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-maxSegmentDiscardSize &lt;0..255&gt; (default: 255)</code></li>
</ul>
</li>
<li>
<p><code style="background-color: #eef;">-loader PeLoader</code></p>
<ul>
<li><code style="background-color: #eef;">-loader-applyLabels &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-anchorLabels &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-linkExistingProjectLibraries &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-projectLibrarySearchFolder &lt;project path&gt;</code></li>
<li><code style="background-color: #eef;">-loader-loadLibraries &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-libraryLoadDepth &lt;depth&gt;</code></li>
<li><code style="background-color: #eef;">-loader-libraryDestinationFolder &lt;project path&gt;</code></li>
<li><code style="background-color: #eef;">-loader-ordinalLookup &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-parseCliHeaders &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-showDebugLineNumbers &lt;true|false&gt;</code></li>
</ul>
</li>
<li>
<p><code style="background-color: #eef;">-loader MachoLoader</code></p>
<ul>
<li><code style="background-color: #eef;">-loader-applyLabels &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-anchorLabels &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-linkExistingProjectLibraries &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-projectLibrarySearchFolder &lt;project path&gt;</code></li>
<li><code style="background-color: #eef;">-loader-loadLibraries &lt;true|false&gt;</code></li>
<li><code style="background-color: #eef;">-loader-libraryLoadDepth &lt;depth&gt;</code></li>
<li><code style="background-color: #eef;">-loader-libraryDestinationFolder &lt;project path&gt;</code></li>
<li><code style="background-color: #eef;">-loader-reexport &lt;true|false&gt;</code></li>
</ul>
</li>
</ul>
<h2 id="authentication" style="border-bottom: solid 1px; border-bottom-color: #cccccc; padding-bottom: 8px;">Authentication</h2>
<p>Use this table to figure out which authentication option to use with the Headless Analyzer, based on
your Ghidra Server's method of authentication, and the type of analysis operation you are
performing.</p>
<table style="border: 1px solid black; border-collapse: collapse; padding: 5px;">
<thead>
<tr>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">Type of Operation</th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">SSH Without Password*</th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">SSH With Password</th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">PKI Without Password</th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">PKI With Password</th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">Username/Password</th>
</tr>
</thead>
<tbody>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">Interactive Command Line</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"><a href="#-keystore-keystorepath">-keystore</a></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">Not Supported</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"><a href="#-keystore-keystorepath">-keystore</a></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"><a href="#-keystore-keystorepath">-keystore</a> and <a href="#-p">-p</a></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"><a href="#-p">-p</a></td>
</tr>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">Batch/Script Use</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"><a href="#-keystore-keystorepath">-keystore</a></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">Not Supported</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"><a href="#-keystore-keystorepath">-keystore</a></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">Not Supported</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">NotSupported</td>
</tr>
</tbody>
</table>
<p><strong>*NOTE:</strong> The use of OpenSSH keys are not supported. The following command can be used to generate
a suitable SSH key while avoiding the unsupported OpenSSH format: <code style="background-color: #eef;">ssh-keygen -b 2048 -t rsa -m pem</code></p>
<h2 id="examples" style="border-bottom: solid 1px; border-bottom-color: #cccccc; padding-bottom: 8px;">Examples</h2>
<h4 id="example-1">Example 1</h4>
<p>Import a binary <code style="background-color: #eef;">/binaries/binary1.exe</code> to a local Ghidra Project named <code style="background-color: #eef;">Project1</code>. Analysis is on
by default.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects Project1 -import /binaries/binary1.exe
</code></pre>
<hr />
<h4 id="example-2">Example 2</h4>
<p>Import all <code style="background-color: #eef;">*.exe</code> binaries from a local folder to a local Ghidra project named <code style="background-color: #eef;">Project1</code>,
suppressing analysis.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects Project1 -import /Users/user/sourceFiles/*.exe -noanalysis
</code></pre>
<hr />
<h4 id="example-3">Example 3</h4>
<p>Import the binary <code style="background-color: #eef;">/usr/local/binaries/binaryA.exe</code> to a subfolder of a local Ghidra Project,
running a prescript, but suppressing analysis.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects Project1/folderOne -scriptPath /usr/scripts -preScript RunThisScriptFirst.java -import /usr/local/binaries/binaryA.exe -noanalysis
</code></pre>
<hr />
<h4 id="example-4">Example 4</h4>
<p>Import the binary <code style="background-color: #eef;">/usr/local/binaries/binaryB.exe</code> to a local Ghidra Project, running a prescript
that depends on a <em>.properties</em> file in the location <code style="background-color: #eef;">/propertiesLocation</code>. Analysis is on by
default.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects Project1 -scriptPath /usr/scripts -preScript RunThisScriptFirst.java -propertiesPath /propertiesLocation -import /usr/local/binaries/binaryB.exe
</code></pre>
<hr />
<h4 id="example-5">Example 5</h4>
<p>Specify more than one import to a local project, running more than one script and performing
analysis.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/Projects Project1/folderOne -scriptPath /usr/scripts -preScript RunThisScriptFirst.java -preScript RunThisScriptSecond.java -import /usr/local/binaries/binaryA.exe /user/local/morebinaries -postScript RunThisScriptLast.java
</code></pre>
<p>OR</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/Projects Project1/folderOne -scriptPath /usr/scripts -preScript RunThisScriptFirst.java -preScript RunThisScriptSecond.java -import /usr/local/binaries/binaryA.exe -postScript RunThisScriptLast.java -import /user/local/morebinaries
</code></pre>
<hr />
<h4 id="example-6">Example 6</h4>
<p>Run a script on an existing project binary <code style="background-color: #eef;">importedBinA.exe</code> in the folder <code style="background-color: #eef;">folderOne</code> of the
existing project named <code style="background-color: #eef;">Project1</code>.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/Projects Project1/folderOne -scriptPath /user/scripts -postScript FixupScript.java -process importedBinA.exe -noanalysis
</code></pre>
<hr />
<h4 id="example-7">Example 7</h4>
<p>Recursively run scripts and analysis over all the binaries in the folder <code style="background-color: #eef;">folderTwo</code> of the existing
project named <code style="background-color: #eef;">Project2</code>.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/Projects Project2/folderTwo -scriptPath /user/scripts -preScript FixupPreScript.java -process -recursive
</code></pre>
<hr />
<h4 id="example-8">Example 8</h4>
<p>Run a script and analysis on binaries starting with the letter <code style="background-color: #eef;">a</code> in the folder <code style="background-color: #eef;">aFolder</code> (and any
of its subfolders) in the existing projected named <code style="background-color: #eef;">Project1</code>.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/Projects Project1/aFolder -scriptPath /user/scripts -preScript ProcessAScript.java -process 'a*' -recursive
</code></pre>
<hr />
<h4 id="example-9">Example 9</h4>
<p>Recursively import the directory <code style="background-color: #eef;">/usr/local/binaries</code> to a Ghidra Server, running a prescript and
analysis. Commit changes with the specified comment. Server prompts for a password for the user
named <code style="background-color: #eef;">userID</code>.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless ghidra://example.server.org:13100/RepositoryName/RootFolder -scriptPath /usr/scripts/ -preScript RunThisScriptFirst.java -import /usr/local/binaries -recursive -connect userID -p -commit &quot;Testing server imports.&quot;
</code></pre>
<hr />
<h4 id="example-10">Example 10</h4>
<p>Change the default log location when importing and analyzing a file.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects Project1 -import /binaries/binary1.exe -log /new/log_location.txt
</code></pre>
<hr />
<h4 id="example-11">Example 11</h4>
<p>Re-import and overwrite a file that already exists in the project.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects Project1 -import /binaries/IAlreadyExist.exe -overwrite
</code></pre>
<hr />
<h4 id="example-12">Example 12</h4>
<p>Create a new project, import and analyze a file, then delete the project when done.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects ANewProject -import /binaries/binary2.exe -deleteProject
</code></pre>
<hr />
<h4 id="example-13">Example 13</h4>
<p>Set a timeout value, in seconds, for analysis (analysis will abort if it takes longer than the set
timeout value).</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects MyProject -import /binaries/binary2.exe -analysisTimeoutPerFile 100
</code></pre>
<hr />
<h4 id="example-14">Example 14</h4>
<p>Run a script without using <code style="background-color: #eef;">-import</code> or <code style="background-color: #eef;">-process</code> modes (<em><strong>Script must not be program-dependent!</strong></em>).</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects MyProject -preScript HelloWorldScript.java -scriptPath /my/ghidra_scripts
</code></pre>
<hr />
<h4 id="example-15">Example 15</h4>
<p>Specify a language and compiler to be used when importing with analysis.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects MyProject -import hello.exe -processor &quot;x86:LE:32:System Management Mode&quot; -cspec default
</code></pre>
<hr />
<h4 id="example-16">Example 16</h4>
<p>Import, run a script, and analyze a file, but don't allow the file to be saved to the project.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects MyProject -import hello.exe -preScript GetInfoScript.java -readOnly
</code></pre>
<hr />
<h4 id="example-17">Example 17</h4>
<p>Import and run scripts that take their own arguments.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects MyProject -import hello.exe -preScript Script.java arg1 arg2 arg3 -preScript AnotherScript.java &quot;arg1 with spaces&quot; arg2
</code></pre>
<hr />
<h4 id="example-18">Example 18</h4>
<p>Import a PE file as a raw binary image with a specified base address and block name.</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects MyProject -import hello.exe -loader BinaryLoader -loader-baseAddr 0x1000 -loader-blockName MyBlock -processor x86:LE:32:default
</code></pre>
<hr />
<h2 id="scripting" style="border-bottom: solid 1px; border-bottom-color: #cccccc; padding-bottom: 8px;">Scripting</h2>
<p>Many scripts that extend the <em>GhidraScript</em> class, and written for use with the headed (GUI) version
of Ghidra, can also be used during Headless operation. However, there are certain GUI-specific
methods that do not make sense when called during Headless operation. When a GhidraScript containing
one or more GUI-specific methods is run headlessly, the script will throw an <code style="background-color: #eef;">ImproperUseException</code>.</p>
<p>A script that extends the <em>HeadlessScript</em> class may be used to write scripts that refer to
Headless-only methods. See the <a href="#headless-scripts">Headless Scripts</a> section for more detail.</p>
<p>Here are some general guidelines for running scripts headlessly.</p>
<ul>
<li>If neither <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode nor <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode is specified in the Headless
Analyzer command line arguments, only the specified pre/post-script(s) will be executed. In this
case, all scripts must execute in a program-independent manner, or errors will occur. If you
intend for scripts to be run against programs, please run in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode.</li>
<li>For each pre-/post-script group, scripts are executed in the order specified on the command line.</li>
<li>Any pre- or post-script may invoke the <code style="background-color: #eef;">setTemporary()</code> method on <code style="background-color: #eef;">currentProgram</code> to prevent
changes from being saved. In <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode, the method prevents the specific import
from being saved. In <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode, the method prevents changes to the program from
being saved.</li>
<li>Avoid using the script API method <code style="background-color: #eef;">setServerCredentials()</code> for shared projects.</li>
</ul>
<h3 id="passing-parameters-using-arguments">Passing Parameters using arguments</h3>
<p>As of Ghidra 7.2, it is possible to pass script-specific arguments directly to scripts. The
arguments are stored in a String array and can be accessed with the following method:</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">String[] args = getScriptArgs();
</code></pre>
<p>If running in headless mode, this array will contain the ordered list of arguments passed to the
script on the command line (specified with <a href="#-prescript-scriptnameext-arg"><code style="background-color: #eef;">-preScript</code></a> or
<a href="#-postscript-scriptnameext-arg"><code style="background-color: #eef;">-postScript</code></a>).</p>
<p>For example, if a script was run with the following command:</p>
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">analyzeHeadless /Users/user/ghidra/projects MyProject -import hello.exe -preScript Script.java arg1 arg2 arg3 -preScript AnotherScript.java &quot;arg1 with spaces&quot; arg2
</code></pre>
<p>Then the elements of the argument array for <em>Script.java</em> would look like this:</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">args = {&quot;arg1&quot;, &quot;arg2&quot;, &quot;arg3&quot;}
</code></pre>
<p>and the argument array for <em>AnotherScript.java</em> would look like this:</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">args = {&quot;arg1 with spaces&quot;, &quot;arg2&quot;}
</code></pre>
<h3 id="passing-parameters-using-askxxx-methods">Passing Parameters using <code style="background-color: #eef;">askXxx()</code> methods</h3>
<p>Many of the GhidraScript <code style="background-color: #eef;">askXxx()</code> methods can be run in both headless and headed (GUI) modes,
allowing seamless script usage between headed and headless modes. As of Ghidra 6.1, the following
methods can be run in both modes:</p>
<ul>
<li><code style="background-color: #eef;">askFile</code></li>
<li><code style="background-color: #eef;">askDirectory</code></li>
<li><code style="background-color: #eef;">askLanguage</code></li>
<li><code style="background-color: #eef;">askProjectFolder</code></li>
<li><code style="background-color: #eef;">askInt</code></li>
<li><code style="background-color: #eef;">askLong</code></li>
<li><code style="background-color: #eef;">askAddress</code></li>
<li><code style="background-color: #eef;">askBytes</code></li>
<li><code style="background-color: #eef;">askProgram</code></li>
<li><code style="background-color: #eef;">askDomainFile</code></li>
<li><code style="background-color: #eef;">askDouble</code></li>
<li><code style="background-color: #eef;">askString</code></li>
<li><code style="background-color: #eef;">askChoice</code></li>
<li><code style="background-color: #eef;">askChoices</code></li>
<li><code style="background-color: #eef;">askYesNo</code></li>
</ul>
<p><em>Further details for each specific <code style="background-color: #eef;">askXxx()</code> method can be found in the method's JavaDoc.</em></p>
<p>When running headlessly, the <code style="background-color: #eef;">askXxx()</code> methods allow users to &quot;pre-set&quot; or &quot;pass in&quot; one or more
values for use in scripts. Use the appropriate method to pass in values of certain types (i.e.,
file, directory, int, long).</p>
<p>To pass a value to a script, create a <em>.properties</em> file corresponding to each GhidraScript that
uses an <code style="background-color: #eef;">askXxx()</code> method. For example, the <em>.properties</em> file that corresponds to a script named
<em>MyScript.java</em> would share the script's basename and be called <em>MyScript.properties</em>. By default,
the Headless Analyzer assumes that the script and its <em>.properties</em> file are both located in the
same folder. If you would like the <em>.properties</em> file to be in a different location from the script,
you can use the <a href="#-propertiespath-path1path2"><code style="background-color: #eef;">-propertiesPath</code></a> parameter to specify the location of the
<em>.properties</em> file. Below is an example of a GhidraScript and its <em>.properties</em> file. Use it for
reference to determine how the <em>.properties</em> file should be structured to communicate the necessary
information to the GhidraScript:</p>
<p><em><strong>Script1.java</strong></em></p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">public class Script1 extends GhidraScript {
 
    @Override
    public void run() throws Exception {
  	
        File userFile = askFile(&quot;Choose a file &quot;, &quot;Please choose a file: &quot;);
        println(&quot;Chosen file: &quot; + userFile.toString());

        double userDouble = askDouble(&quot;Double dialog&quot;, &quot;Please enter a double: &quot;);
        println(&quot;Entered double: &quot; + userDouble);
	
        double userDouble2 = askDouble(&quot;Double dialog&quot;, &quot;Please enter another double: &quot;);
        println(&quot;Second entered double: &quot; + userDouble2);

        Address userAddress = askAddress(&quot;Address&quot;, &quot;Enter an address!&quot;);
        println(&quot;Entered address: &quot; + userAddress.toString());

        byte[] userBytes = askBytes(&quot;Asking for bytes&quot;, &quot;Put some bytes here --&quot;);
        StringBuilder byteStr = new StringBuilder();
        for (byte aByte : askedBytes) {
            byteStr.append(String.format(&quot;%02X &quot;, aByte));
        }
        println(&quot;Bytes: &quot; + byteStr.toString().trim());
	
        String userString = askString(&quot;Asking for a string&quot;, &quot;Please type a string: &quot;, &quot;my default String&quot;);
        println(&quot;Entered String: &quot; + userString);
    }
}
</code></pre>
<p><em><strong>Script1.properties</strong></em></p>
<pre style="background-color: #eef;"><code class="language-ini" style="background-color: #eef;">    # A comment line is indicated if the '#' or '!' character is the first non-whitespace character 
    # of that line.
    # 
    # Use a space-separated concatenation of the parameters to communicate which variable gets what 
    # value:
    #    Format:    &lt;space-separated concatenation of parameters&gt; = &lt;value&gt;
    #
    # Notice that spaces at the beginning and end of parameters are removed prior to concatenation.
    #
    # Note that if the askXxx() method contains a &quot;defaultValue&quot; parameter, that parameter should 
    # not be included in the concatenation of parameters.

    Choose a file Please choose a file: = /Users/username/help.exe
    Double dialog Please enter a double: = 32.2
    Address Enter an address! = 0x10AB34D
    Double dialog Please enter another double: = 3.14159 
    Asking for bytes Put some bytes here -- = AA BB CC 11 02 24
    Asking for a string Please type a string: = STRING ABC
</code></pre>
<p><strong>Note:</strong> If <a href="#passing-parameters-using-arguments">script-specific arguments</a> have been passed into
the script, the <code style="background-color: #eef;">askXxx()</code> methods will consume values found in the argument array rather than a
<em>.properties</em> file. The first <code style="background-color: #eef;">askXxx()</code> method will use the first value in the array, the second
<code style="background-color: #eef;">askXxx()</code> method will use the second value in the array, and so on. If all of the arguments in the
array have been consumed, the next <code style="background-color: #eef;">askXxx()</code> will throw an <code style="background-color: #eef;">IndexOutOfBoundsException</code>.</p>
<h3 id="headless-scripts">Headless Scripts</h3>
<p>A script of type <em>HeadlessScript</em> (which extends <em>GhidraScript</em>) can be used by any user looking for
more control over the Headless Analysis process than is offered using the more generic
<em>GhidraScript</em> class. Using <em>HeadlessScripts</em>, users are able to store variables for use by later
scripts, change the location of where an import will be saved, and change the disposition of a
program depending on script-specific conditions (i.e., save it in a different folder, delete it,
turn off analysis, abort further processing, etc.).</p>
<p><em>HeadlessScripts</em> allow the user to access certain methods that are specific to the
HeadlessAnalyzer. Otherwise, these types of scripts operate exactly like <em>GhidraScripts</em>. Users
should <em><strong>only</strong></em> use <em>HeadlessScript</em> for headless operation. While <em>HeadlessScripts</em> could
possibly run successfully in the Ghidra GUI, an exception will be thrown if a HeadlessScript-only
method is called during GUI operation.</p>
<h4 id="enablingdisabling-analysis">Enabling/Disabling Analysis</h4>
<p>In order to enable or disable analysis using a <em>HeadlessScript</em>, simply include the following line
in your script:</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">enableHeadlessAnalysis(true);  // turn on analysis
</code></pre>
<p>OR</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">enableHeadlessAnalysis(false);  // turn off analysis
</code></pre>
<p>Note that a script that includes this line should be run as a <code style="background-color: #eef;">preScript</code>, since preScripts execute
before analysis would typically run. Running the script as a <code style="background-color: #eef;">postScript</code> is ineffective, since the
stage at which analysis would have happened has already passed.</p>
<p>This change will persist throughout the current HeadlessAnalyzer session, unless changed again (in
other words, once analysis is enabled via script for one program, it will also be enabled for future
programs in the current session, unless changed).</p>
<p>Note: To check whether analysis is currently enabled, use the following method:</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">boolean analysisEnabled = isHeadlessAnalysisEnabled();
</code></pre>
<h4 id="setting-the-import-directory">Setting the Import Directory</h4>
<p>When using <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode, a user can change the path in the Ghidra project where imported
files are saved. This is done by using the following script method:</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">setHeadlessImportDirectory(&quot;path/to/new/dir&quot;);
</code></pre>
<p>The new path does not have to exist (it will be created if it doesn't already exist). The path is
also assumed to be relative to the project's root folder.</p>
<p>Here are some examples assuming the Ghidra project structure looks like this:</p>
<pre style="background-color: #eef;"><code style="background-color: #eef;">    MyGhidraProject:
        /dir1
            /innerDir1
            /innerDir2
</code></pre>
<ul>
<li>The following usage ensures that any files imported after the call to this method are saved in the
existing <code style="background-color: #eef;">MyGhidraProject:dir1/innerDir2</code> folder:
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">setHeadlessImportDirectory(&quot;dir1/innerDir2&quot;);
</code></pre>
</li>
<li>In contrast, the following usage adds new folders to the Ghidra project and saves the imported
files into the newly-created path.
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;"> setHeadlessImportDirectory(&quot;dir1/innerDir2/my/folder&quot;);
</code></pre>
changes the directory structure to:
<pre style="background-color: #eef;"><code style="background-color: #eef;">  MyGhidraProject:
      /dir1
          /innerDir1
          /innerDir2
              /my
                  /folder
</code></pre>
</li>
<li>Another usage example where new folders are added to the Ghidra project.
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">setHeadlessImportDirectory(&quot;dir1/newDir/saveHere&quot;);
</code></pre>
This changes the directory structure to:
<pre style="background-color: #eef;"><code style="background-color: #eef;">  MyGhidraProject:
      /dir1
          /innerDir1
          /innerDir2
          /newDir
              /saveHere
</code></pre>
</li>
</ul>
<p>When using this method to set the save directory for imports, whether the save succeeds may depend
on the state of the <a href="#-overwrite"><code style="background-color: #eef;">-overwrite</code></a> parameter. For example, if the new import location
already exists and contains a file of the same name as the current program, the current program will
only be successfully saved if <a href="#-overwrite"><code style="background-color: #eef;">-overwrite</code></a> is enabled.</p>
<p>This change in import directory will persist throughout the current HeadlessAnalyzer session, unless
changed again (in other words, once the import location has been changed, it will continue to be the
import save location for future imported programs in the current session, unless changed again).</p>
<p>To revert back to the default import location (that which was specified via command line), pass the
null object as the argument to this method:</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">setHeadlessImportDirectory(null);    // Sets import save directory to default
</code></pre>
<p>The <code style="background-color: #eef;">setHeadlessImportDirectory()</code> method is ineffective in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode (the program
will <em><strong>not</strong></em> be saved to a different location if this method is called when running in
<a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode).</p>
<h4 id="checking-for-analysis-timeout">Checking for Analysis Timeout</h4>
<p>In the case where all of the following apply:</p>
<ul>
<li>the user set an analysis timeout period using the <a href="#-analysistimeoutperfile-timeout-in-seconds"><code style="background-color: #eef;">-analysisTimeoutPerFile</code></a> parameter</li>
<li>analysis is enabled and has completed</li>
<li>the current script is being run as a postScript</li>
</ul>
<p>The user can check whether analysis timed out, using the following query method:</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">boolean didTimeout = analysisTimeoutOccurred();
</code></pre>
<h4 id="passing-values-between-scripts">Passing Values Between Scripts</h4>
<p>If you are running multiple scripts in headless operation and would like to store a value in one
script that is accessible by another script, use the <em>HeadlessScript</em> methods below. They facilitate
the storage and retrieval of key-value pairs to/from a data structure that is available to any
script of type <em>HeadlessScript</em>:</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">storeHeadlessValue(String key, Object value);
Object myObject = getStoredHeadlessValue(String key);
boolean containsKey = headlessStorageContainsKey(String key);
</code></pre>
<h4 id="using-scripts-to-control-program-disposition">Using Scripts to Control Program Disposition</h4>
<p>HeadlessScripts can be used to control disposition of the program currently being imported/processed
(note: if running in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode with <a href="#-readonly"><code style="background-color: #eef;">-readOnly</code></a> enabled, programs can
not be deleted, even if directed by a script).</p>
<p>The available options to control program disposition are as follows:</p>
<ul>
<li><code style="background-color: #eef;">HeadlessContinuationOption.ABORT</code>
<ul>
<li>in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode, does not run any follow-on scripts/analysis; program is imported.</li>
<li>in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode, does not run any follow-on scripts/analysis; changes to the
current (existing) program are saved.</li>
</ul>
</li>
<li><code style="background-color: #eef;">HeadlessContinuationOption.ABORT_AND_DELETE</code>
<ul>
<li>in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode, does not run any follow-on  scripts/analysis; program is not
imported.</li>
<li>in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode, does not run any follow-on scripts/analysis; the current
(existing) program is deleted.</li>
</ul>
</li>
<li><code style="background-color: #eef;">HeadlessContinuationOption.CONTINUE_THEN_DELETE</code>
<ul>
<li>in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode, continues to run any follow-on scripts/analysis; program is not
imported.</li>
<li>in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode, continues to run any follow-on scripts/analysis; the current
(existing) program is deleted after processing is complete.</li>
</ul>
</li>
<li><code style="background-color: #eef;">HeadlessContinuationOption.CONTINUE</code> (<strong>default setting</strong>)
<ul>
<li>in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode, continues to run any follow-on scripts/analysis; program is
imported.</li>
<li>in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode, continues to run any follow-on scripts/analysis; changes to the
current (existing) program are saved.</li>
</ul>
</li>
</ul>
<p>To set the program disposition, use the <code style="background-color: #eef;">setHeadlessContinuationOption()</code> method. For example, to
dictate that further processing be aborted and the program deleted, the script should use the
following method with the <code style="background-color: #eef;">ABORT_AND_DELETE</code> option:</p>
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">setHeadlessContinuationOption(HeadlessContinuationOption.ABORT_AND_DELETE);
</code></pre>
<p>At the start of processing for each program (immediately before the first script runs), the
script's continuation option is set to <code style="background-color: #eef;">CONTINUE</code> by default. If the
<code style="background-color: #eef;">setHeadlessContinationOption()</code> method is not used, then operation continues as normal.</p>
<p>Note that when an option is set, it takes effect AFTER the current script completes. For example,
setting the continuation option to <code style="background-color: #eef;">ABORT</code> does <strong>not</strong> immediately abort the current script;
instead, it aborts any processing (analysis, other scripts) that immediately follow the current
script.</p>
<p>In the case where a subscript or secondary script sets an <code style="background-color: #eef;">ABORT</code>or <code style="background-color: #eef;">ABORT_AND_DELETE</code> option, that
option will go into effect once the primary (or outermost) script has completed execution.</p>
<p>For a very basic example script, see <em>SetHeadlessContinuationOptionScript.java</em>, which is included
in the Ghidra distribution.</p>
<p>When multiple scripts set program disposition, they are combined. Continue on to the next section
to understand how this works.</p>
<h4 id="using-multiple-scripts-to-control-program-disposition">Using Multiple Scripts to Control Program Disposition</h4>
<p>While running scripts that change the program disposition, there may be instances when the program
disposition is changed more than once for the same program. Some cases where this could happen are:</p>
<ul>
<li>when the user runs multiple pre-scripts and/or post-scripts that use
<code style="background-color: #eef;">setHeadlessContinuationOption()</code></li>
<li>when the user runs scripts that call sub-scripts (or secondary scripts) that use
<code style="background-color: #eef;">setHeadlessContinuationOption()</code></li>
<li>when the user runs a script that makes multiple calls to the <code style="background-color: #eef;">setHeadlessContinuationOption()</code>
method</li>
</ul>
<p>If there are multiple calls to <code style="background-color: #eef;">setHeadlessContinuationOption()</code> within a single script, the last
method call is used as the setting dictated by that script.</p>
<p>However, if multiple scripts make calls to <code style="background-color: #eef;">setHeadlessContinuationOption()</code>, the options from each
script are combined in a rational way (in the order the options were set) to potentially result in a
new continuation option.</p>
<p>For example, if <em>Script1.java</em> sets the continuation option (left column), then is followed by
<em>Script2.java</em> which also sets the continuation option (column headers), the resulting continuation
status is shown in the following table:</p>
<table style="border: 1px solid black; border-collapse: collapse; padding: 5px;">
<thead>
<tr>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;"></th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT</th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT_AND_DELETE</th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">CONTINUE_THEN_DELETE</th>
<th style="border: 1px solid black; border-collapse: collapse; padding: 5px;">CONTINUE</th>
</tr>
</thead>
<tbody>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"><strong>ABORT</strong></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT*</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT*</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT*</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT*</td>
</tr>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"><strong>ABORT_AND_DELETE</strong></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT_AND_DELETE*</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT_AND_DELETE*</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT_AND_DELETE*</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT_AND_DELETE*</td>
</tr>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"><strong>CONTINUE_THEN_DELETE</strong></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT_AND_DELETE</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT_AND_DELETE</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">CONTINUE_THEN_DELETE</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">CONTINUE_THEN_DELETE</td>
</tr>
<tr>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;"><strong>CONTINUE</strong></td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">ABORT_AND_DELETE</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">CONTINUE_THEN_DELETE</td>
<td style="border: 1px solid black; border-collapse: collapse; padding: 5px;">CONTINUE</td>
</tr>
</tbody>
</table>
<p><strong>*NOTE:</strong> In cases where <em>Script1</em> specifies <code style="background-color: #eef;">ABORT</code> or <code style="background-color: #eef;">ABORT_AND_DELETE</code>, <em>Script2</em> will not run
unless <em>Script2</em> is a subscript or secondary script called by <em>Script1</em>.</p>
<p>Keep in mind:</p>
<ul>
<li>If <em>Script2</em> does not change the continuation option, then the status from <em>Script1</em> will carry
over.</li>
<li>An <code style="background-color: #eef;">ABORT</code> at the postScript stage is still meaningful in stopping further processing, since
follow-on analysis may occur as a result of changes made by the postScript.</li>
<li>You can check the current continuation option by using the <code style="background-color: #eef;">getHeadlessContinuationOption()</code>
method. For example:
<pre style="background-color: #eef;"><code class="language-java" style="background-color: #eef;">HeadlessContinuationOption currentOption = getHeadlessContinuationOption();
</code></pre>
<ul>
<li>When specifying deletion options such as <code style="background-color: #eef;">ABORT_AND_DELETE</code> or <code style="background-color: #eef;">CONTINUE_THEN_DELETE</code> in
<a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode, be sure to include <a href="#-oktodelete"><code style="background-color: #eef;">-okToDelete</code></a> in the command line
parameters to verify that deletions are allowed. This is an extra safety step to ensure
programs aren't deleted when the user didn't mean to delete them.</li>
</ul>
</li>
</ul>
<h2 id="wildcards" style="border-bottom: solid 1px; border-bottom-color: #cccccc; padding-bottom: 8px;">Wildcards</h2>
<p>Wildcards can be used when specifying files and/or directories for <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode, or when
specifying one or more files for <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode. Wildcards in <a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode
are expanded by the underlying system shell before being passed on to headless Ghidra (consequently,
any wildcard limitations will be dictated by the specific operating system you are using). Wildcards
in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode are expanded by headless Ghidra and are limited to the use of <code style="background-color: #eef;">*</code> and
<code style="background-color: #eef;">?</code> only.</p>
<p>Note that wildcarding is NOT supported for specifying the Ghidra project/repository location or
folder path.</p>
<p>Below are some general guidelines for wildcard usage:</p>
<ul>
<li>
<p><a href="#-import-directoryfile"><code style="background-color: #eef;">-import</code></a> mode</p>
<ul>
<li>During import, the rules for wildcard use depend on the operating system on which the Headless
Analyzer is being run. The operating system will expand the wildcards to a list of matching
files and pass the list to the Headless Analyzer.</li>
<li>Unix-based Operating Systems allow the following wildcards:
<ul>
<li>Use the <code style="background-color: #eef;">*</code> character to substitute for zero or more characters</li>
<li>Use the <code style="background-color: #eef;">?</code> character to substitute for exactly one character</li>
<li>Use ranges of characters enclosed in square brackets (for example, <code style="background-color: #eef;">[a-z]</code>) to substitute for
any one of the characters in that range. Negation of the characters is also allowed by using a
leading <code style="background-color: #eef;">!</code> within the brackets (i.e., <code style="background-color: #eef;">[!a-z]</code>).</li>
<li>Wildcards can expand to either directories or files</li>
</ul>
</li>
<li>Windows allows the following wildcards:
<ul>
<li>Use the <code style="background-color: #eef;">*</code> character to substitute for zero or more characters</li>
<li>Use the <code style="background-color: #eef;">?</code> to substitute for one character or less</li>
<li>Wildcards can only expand to files (directories whose names conform to the wildcard string
will not be returned)</li>
</ul>
</li>
<li>When using a wildcard to specify files, be sure to use as specific of a string as possible.
There may be unintended consequences to using more generalized wildcard strings, such as:
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">./analyzeHeadless /home/usr/ghidra/projects TestProj -import /home/files/n*
</code></pre>
When using a Unix-based operating system, this import specification results in not only all
files in <code style="background-color: #eef;">/home/files</code> starting with <em>n</em> to be imported, but also the contents of the all
directories starting with <em>n</em> to be imported (contents of those directories' subdirectories
would also be imported, if the <a href="#-recursive-depth"><code style="background-color: #eef;">-recursive</code></a> option was specified -- note  that the
contents of the directories starting with <em>n</em> are not also subject to the restriction that they
start with <em>n</em>).</li>
</ul>
</li>
<li>
<p><a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode</p>
<ul>
<li>In process mode, the wildcard string applies only to files, not directories. The only accepted
wildcard characters are <code style="background-color: #eef;">*</code> and <code style="background-color: #eef;">?</code>.</li>
<li>There are some cases where the wildcard string may be prematurely expanded by the operating
system. For example, in order to run in <a href="#-process-project_file"><code style="background-color: #eef;">-process</code></a> mode over all existing project
files that start with the letter <em>a</em>, one might use the following command:
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">./analyzeHeadless /home/usr/ghidra/projects TestProj -process a* -recursive
</code></pre>
</li>
<li>Instead of the &quot;a*&quot; string being passed along to be used within the Ghidra project, the shell
will prematurely expand the wildcard string to match all <em>a</em>-prefixed files in the current
directory. The command ends up looking like this:
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">./analyzeHeadless /home/usr/ghidra/projects TestProj -process analyzeHeadless -recursive
</code></pre>
</li>
<li>In order to prevent the system shell from doing this premature wildcard expansion, simply
surround the wildcard string with single-quote characters:
<pre style="background-color: #eef;"><code class="language-bash" style="background-color: #eef;">./analyzeHeadless /home/usr/ghidra/projects TestProj -process 'a*' -recursive
</code></pre>
</li>
</ul>
</li>
</ul>
<section class="footnotes" data-footnotes>
<ol>
<li id="fn-1">
<p>Address must be in the form <code style="background-color: #eef;">[space:]offset</code>. Space is optional, and offset is a hex valuewith no leading <code style="background-color: #eef;">0x</code>. <a href="#fnref-1" class="footnote-backref" data-footnote-backref data-footnote-backref-idx="1" aria-label="Back to reference 1">↩</a></p>
</li>
<li id="fn-2">
<p>To specify hexadecimal, use a leading <code style="background-color: #eef;">0x</code>. <a href="#fnref-2" class="footnote-backref" data-footnote-backref data-footnote-backref-idx="2" aria-label="Back to reference 2">↩</a> <a href="#fnref-2-2" class="footnote-backref" data-footnote-backref data-footnote-backref-idx="2-2" aria-label="Back to reference 2-2"><sup class="footnote-ref">2</sup>↩</a></p>
</li>
<li id="fn-3">
<p>Base address is in the default space and must be specified as a hexadecimal value without the leading <code style="background-color: #eef;">0x</code>. <a href="#fnref-3" class="footnote-backref" data-footnote-backref data-footnote-backref-idx="3" aria-label="Back to reference 3">↩</a></p>
</li>
<li id="fn-4">
<p>Base address is in the default data space and must be specified as a hexadecimal value without the leading <code style="background-color: #eef;">0x</code>.
This option only applies to Harvard Architecture processors when loading relocatable ELF binaries (i.e., object modules). <a href="#fnref-4" class="footnote-backref" data-footnote-backref data-footnote-backref-idx="4" aria-label="Back to reference 4">↩</a></p>
</li>
</ol>
</section>
